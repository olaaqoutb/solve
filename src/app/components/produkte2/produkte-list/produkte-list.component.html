<div class="container fade-in">
  <div class="header">
    <div class="left-section">
      <mat-icon class="menue">menu</mat-icon>
      <button mat-raised-button class="neu-button" (click)="addProduct()">
        <mat-icon>widgets</mat-icon>
        Neu
      </button>
    </div>

    <div class="center-section">
      <span class="title">Produkte</span>
    </div>

    <div class="right-section">
      <div class="checkbox-container">
        <mat-checkbox
          class="inkle-inactive"
          [(ngModel)]="showInactive"
          (change)="onCheckboxChange()"
        >
          inkl. inaktive
        </mat-checkbox>
      </div>

      <div class="search-container">
        <input
          type="text"
          placeholder="Suche"
          [(ngModel)]="searchTerm"
          (input)="filterData()"
          class="search-input"
        />
        <mat-icon class="search-icon">search</mat-icon>
      </div>
    </div>
  </div>


  <div class="table-container">
    <table
      mat-table
      [dataSource]="dataSource"
      matSort
      class="mat-elevation-z8"
      *ngIf="dataSource.data.length"
    >
      <!-- Column definitions with mat-sort-header -->
      <!-- KURZNAME -->
      <ng-container matColumnDef="kurzName">
        <th mat-header-cell *matHeaderCellDef (click)="toggleSort('kurzName')">
          Kurzname
          <button
            (click)="toggleSort('kurzName')"
            style="background: none; border: none; cursor: pointer"
          >
            <span *ngIf="sortState['kurzName'] === 'asc'"
              ><mat-icon class="sort-arrow" (click)="toggleSort('kurzName')"
                >keyboard_arrow_up</mat-icon
              ></span
            >
            <span *ngIf="sortState['kurzName'] === 'desc'"
              ><mat-icon class="sort-arrow" (click)="toggleSort('kurzName')"
                >keyboard_arrow_down</mat-icon
              ></span
            >
          </button>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.kurzName || "-" }}
        </td>
      </ng-container>

      <!-- PRODUKTNAME -->
      <ng-container matColumnDef="produktname">
        <th
          mat-header-cell
          *matHeaderCellDef
          (click)="toggleSort('produktname')"
        >
          Produktname
          <button
            (click)="toggleSort('produktname')"
            style="background: none; border: none; cursor: pointer"
          >
            <span *ngIf="sortState['produktname'] === 'asc'"
              ><mat-icon class="sort-arrow" (click)="toggleSort('produktname')"
                >keyboard_arrow_up</mat-icon
              ></span
            >
            <span *ngIf="sortState['produktname'] === 'desc'"
              ><mat-icon class="sort-arrow" (click)="toggleSort('produktname')"
                >keyboard_arrow_down</mat-icon
              ></span
            >
          </button>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.produktname || "-" }}
        </td>
      </ng-container>

      <!-- START -->
      <ng-container matColumnDef="start">
        <th mat-header-cell *matHeaderCellDef (click)="toggleSort('start')">
          Start
          <button
            (click)="toggleSort('start')"
            style="background: none; border: none; cursor: pointer"
          >
            <span *ngIf="sortState['start'] === 'asc'"
              ><mat-icon class="sort-arrow" (click)="toggleSort('start')"
                >keyboard_arrow_up</mat-icon
              ></span
            >
            <span *ngIf="sortState['start'] === 'desc'"
              ><mat-icon class="sort-arrow" (click)="toggleSort('start')"
                >keyboard_arrow_down</mat-icon
              ></span
            >
          </button>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.start | date : "dd.MM.yyyy" }}
        </td>
      </ng-container>

      <!-- ENDE -->
      <ng-container matColumnDef="ende">
        <th mat-header-cell *matHeaderCellDef (click)="toggleSort('ende')">
          Ende
          <button
            (click)="toggleSort('ende')"
            style="background: none; border: none; cursor: pointer"
          >
            <span *ngIf="sortState['ende'] === 'asc'"
              ><mat-icon class="sort-arrow" (click)="toggleSort('ende')"
                >keyboard_arrow_up</mat-icon
              ></span
            >
            <span *ngIf="sortState['ende'] === 'desc'"
              ><mat-icon class="sort-arrow" (click)="toggleSort('ende')"
                >keyboard_arrow_down</mat-icon
              ></span
            >
          </button>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.ende | date : "dd.MM.yyyy" }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: displayedColumns"
        [class.inactive-row]="!row.aktiv"
        (click)="goToDetails(row)"
        class="list-row"
      ></tr>
    </table>
  </div>
</div>
